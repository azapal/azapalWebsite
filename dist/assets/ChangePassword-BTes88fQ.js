import{d as E,r as m,x as v,o as V,c as f,b as s,y as B,l as x,z as g,A as b,B as D,n as y,u as h,v as M,g as _,e as N,i as R,j as U,k as d}from"./index-DNeNtjwR.js";import{S as q,n as a}from"./storeUtils-DUStbxJ3.js";import{C as O,b as k}from"./authenticationRequest-gtOJk9va.js";import{E as T,a as A}from"./eye-B0g0EbvR.js";import"./createLucideIcon-LynU3fMy.js";const F={class:"min-h-screen flex flex-col bg-white"},j={class:"flex-1 flex flex-col items-center justify-center px-4 py-12"},z={class:"w-full max-w-md"},L={key:0,class:"border-gray-200 px-3 py-2 text-center"},$={key:1},G={for:"verify_otp",class:"block relative mb-5 overflow-hidden rounded-md border border-gray-200 px-3 py-2 shadow-xs focus-within:border-orange-600 focus-within:ring-1 focus-within:ring-orange-600"},H={for:"change_old_password",class:"block relative mb-5 overflow-hidden rounded-md border border-gray-200 px-3 py-2 shadow-xs focus-within:border-orange-600 focus-within:ring-1 focus-within:ring-orange-600"},I={for:"change_new_password",class:"block relative mb-5 overflow-hidden rounded-md border border-gray-200 px-3 py-2 shadow-xs focus-within:border-orange-600 focus-within:ring-1 focus-within:ring-orange-600"},J=["type"],K=["disabled"],Q={class:"text-center mt-6"},W={class:"text-gray-600"},oe=E({__name:"ChangePassword",setup(X){const i=m(!1),u=v.currentRoute.value.query,p=q,w=p.get("auth","getCurrentUser"),t=m(!1),r=m(O),c=m(!1),C=async()=>{var o;t.value=!0,k.email=w.value.email;try{const l=(await p.dispatch("auth","sendEmailOtp",k)).data;l.response_code==="00"?(t.value=!1,a(l.response_message,"success"),i.value=!0):(a(l.response_message,"success"),t.value=!1)}catch(e){t.value=!1,(o=e==null?void 0:e.response)!=null&&o.data?a(String(e.response.data.message),"error"):a(String(e),"error")}},P=async()=>{t.value=!0,r.value.email=w.value.email;try{const o=await p.dispatch("auth","changePassword",r.value);console.log(o);let e=o.data;t.value=!1,e.code==="00"?(a(e.message,"success"),v.back()):a(e.message,"error")}catch(o){t.value=!1,console.log("error:",o),a(String(o),"error")}},S=()=>{i.value?P():C()};return V(()=>{if(u.code)return p.dispatch("auth","tictokLogin_",{access_token:u==null?void 0:u.code})}),(o,e)=>{const l=U("router-link");return d(),f("div",F,[s("div",j,[s("div",z,[e[11]||(e[11]=s("div",{class:"text-center"},[s("a",{href:"/",class:"lg:text-3xl text-lg font-bold bg-gradient-to-r from-[#F97316] to-[#2563EB] text-transparent bg-clip-text inline-block lg:mb-4 mb-2"}," Aza-pal ")],-1)),s("form",{onSubmit:B(S,["prevent"]),class:"space-y-5"},[i.value?x("",!0):(d(),f("div",L,e[4]||(e[4]=[s("p",{class:"font-medium text-gray-700 text-center"}," Are you sure you want to change your password? ",-1)]))),i.value?(d(),f("div",$,[e[8]||(e[8]=s("p",{class:"font-medium text-gray-700 text-center mb-4"}," Type in your new password ",-1)),s("label",G,[e[5]||(e[5]=s("span",{class:"text-xs font-medium text-gray-700"}," OTP ",-1)),g(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>r.value.otp=n),id:"verify_otp",placeholder:"enter value",class:"mt-1 w-full border-none bg-transparent p-0 focus:border-transparent focus:ring-0 focus:outline-hidden sm:text-sm"},null,512),[[b,r.value.otp]])]),s("label",H,[e[6]||(e[6]=s("span",{class:"text-xs font-medium text-gray-700"}," old password ",-1)),g(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=n=>r.value.old_password=n),id:"change_old_password",placeholder:"********",class:"mt-1 w-full border-none bg-transparent p-0 focus:border-transparent focus:ring-0 focus:outline-hidden sm:text-sm"},null,512),[[b,r.value.old_password]])]),s("label",I,[e[7]||(e[7]=s("span",{class:"text-xs font-medium text-gray-700"}," new password ",-1)),g(s("input",{type:c.value?"text":"password","onUpdate:modelValue":e[2]||(e[2]=n=>r.value.password=n),id:"change_new_password",placeholder:"********",class:"mt-1 w-full border-none bg-transparent p-0 focus:border-transparent focus:ring-0 focus:outline-hidden sm:text-sm"},null,8,J),[[D,r.value.password]]),s("span",{class:"absolute top-8 right-5 cursor-pointer",onClick:e[3]||(e[3]=n=>c.value=!c.value)},[c.value?(d(),y(h(T),{key:0})):(d(),y(h(A),{key:1}))])])])):x("",!0),s("button",{type:"submit",class:"w-full bg-[#F97316] hover:bg-orange-400 rounded-[12px] p-[8px] cursor-pointer text-white",disabled:t.value},M(t.value?"Please chillax, it's working.":"Proceed"),9,K)],32),s("div",Q,[s("p",W,[e[10]||(e[10]=_(" Never mind? ")),N(l,{to:"/settings",class:"text-[#F97316] font-medium cursor-pointer"},{default:R(()=>e[9]||(e[9]=[_(" Cancel ")])),_:1})])])])])])}}});export{oe as default};
