import{d as F,C as L,x as f,r as b,o as M,c as h,n as v,l as x,b as t,u as l,v as y,y as R,z as _,A as q,B as U,e as N,i as T,j as $,g as k,F as j,k as c}from"./index-DTq0z6UM.js";import{_ as z}from"./icons8-tiktok-B1AwSpcc.js";import{u as A,S as P,n as u}from"./storeUtils-BBgzQjYe.js";import{L as I,b as S}from"./authenticationRequest-gtOJk9va.js";import{_ as J}from"./OtpValidation-uzaiQW1i.js";import{E as K,a as W}from"./eye-B7GVtcCM.js";import"./createLucideIcon-BHDqzYJA.js";const Y={class:"min-h-screen flex flex-col bg-white"},G={class:"flex-1 flex flex-col items-center justify-center px-4 py-12"},H={class:"w-full max-w-md"},Q={class:"space-y-4 lg:mb-8 mb-4"},X=["disabled"],Z={class:"relative lg:mb-8 mb-4"},ee={class:"relative flex justify-center text-sm"},te={class:"px-2 bg-white text-gray-500"},se={key:0,for:"login_email",class:"block mb-5 overflow-hidden rounded-md border border-gray-200 px-3 py-2 shadow-xs focus-within:border-orange-600 focus-within:ring-1 focus-within:ring-orange-600"},oe={key:1,for:"login_password",class:"block relative mb-5 overflow-hidden rounded-md border border-gray-200 px-3 py-2 shadow-xs focus-within:border-orange-600 focus-within:ring-1 focus-within:ring-orange-600"},ae=["type"],re={class:"w-full text-right underline cursor-pointer text-sm lg:text-md"},ne=["disabled"],le="sbaw37v8xwwou3v490",ie="https://number1fans.vercel.app/create-account",he=F({__name:"Login",setup(de){const C=A(),{isVerificationDone:p}=L(C),m=f.currentRoute.value.query,r=P,s=b(!1);let E=r.get("auth","getShowOtpScreen");const V=a=>{const e=Math.random().toString(36).substring(2);localStorage.setItem("csrfState",e);{const i=`https://www.tiktok.com/v2/auth/authorize/?client_key=${le}&response_type=code&scope=user.info.basic&redirect_uri=${ie}&state=${e}`;window.location.href=i}},n=b(I),g=b(!1),O=async()=>{s.value=!0,S.email=n.value.email;try{const e=(await r.dispatch("auth","sendEmailOtp",S)).data;e.response_code==="00"?(r.commit("auth","showOtpScreen",!0),s.value=!1,u(e.response_message,"success")):(u(e.response_message,"success"),s.value=!1)}catch(a){s.value=!1,a.response.data?u(String(a.response.data.message),"error"):u(String(a),"error")}},B=async()=>{var a,e,i;s.value=!0;try{const o=await r.dispatch("auth","login",n.value);console.log(o);let d=o.data;if(s.value=!1,d.code==="00"){const w=(i=(e=(a=f.currentRoute)==null?void 0:a.value)==null?void 0:e.query)==null?void 0:i.redirectFrom;r.commit("auth","token",d.token),r.commit("auth","user",d.data),localStorage.user=JSON.stringify(d.data),localStorage.token=d.token,w?await f.push({path:String(w)}):await f.push({path:"/business/vendor"})}else u(d.message,"error")}catch(o){s.value=!1,console.log("error:",o),u(String(o),"error")}},D=()=>{p.value?B():O()};return M(()=>{if(m.code)return r.dispatch("auth","tictokLogin_",{access_token:m==null?void 0:m.code})}),(a,e)=>{const i=$("router-link");return c(),h(j,null,[l(E)?(c(),v(J,{key:0,page:"login",data:n.value},null,8,["data"])):x("",!0),t("div",Y,[t("div",G,[t("div",H,[e[9]||(e[9]=t("div",{class:"text-center lg:mb-8 mb-4"},[t("a",{href:"/",class:"lg:text-3xl text-lg font-bold bg-gradient-to-r from-[#F97316] to-[#2563EB] text-transparent bg-clip-text inline-block lg:mb-4 mb-2"}," Aza-pal "),t("h1",{class:"lg:text-2xl text-lg font-bold text-gray-900 mb-2"},"Welcome Back."),t("p",{class:"text-gray-600 text-sm"}," Social Commerce Made Easy. ")],-1)),t("div",Q,[t("button",{class:"w-full flex items-center p-2 rounded-[8px] cursor-pointer hover:scale-105 justify-center gap-2 font-medium border border-gray-300",onClick:e[0]||(e[0]=()=>V()),disabled:s.value},e[4]||(e[4]=[t("img",{src:z,class:"w-5 h-5",alt:"tiktok"},null,-1),t("span",null,"Continue with TikTok",-1)]),8,X)]),t("div",Z,[e[5]||(e[5]=t("div",{class:"absolute inset-0 flex items-center"},[t("div",{class:"w-full border-t border-gray-300"})],-1)),t("div",ee,[t("span",te,y(l(p)?"Your email was verified now enter your password":"Or continue with email"),1)])]),t("form",{onSubmit:R(D,["prevent"]),class:"space-y-5"},[l(p)?x("",!0):(c(),h("label",se,[e[6]||(e[6]=t("span",{class:"text-xs font-medium text-gray-700"}," email ",-1)),_(t("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=o=>n.value.email=o),id:"login_email",placeholder:"example@email.com",class:"mt-1 w-full border-none bg-transparent p-0 focus:border-transparent focus:ring-0 focus:outline-hidden sm:text-sm",required:""},null,512),[[q,n.value.email]])])),l(p)?(c(),h("label",oe,[e[7]||(e[7]=t("span",{class:"text-xs font-medium text-gray-700"}," password ",-1)),_(t("input",{type:g.value?"text":"password","onUpdate:modelValue":e[2]||(e[2]=o=>n.value.password=o),id:"login_password",placeholder:"********",class:"mt-1 w-full border-none bg-transparent p-0 focus:border-transparent focus:ring-0 focus:outline-hidden sm:text-sm"},null,8,ae),[[U,n.value.password]]),t("span",{class:"absolute top-8 right-5 cursor-pointer",onClick:e[3]||(e[3]=o=>g.value=!g.value)},[g.value?(c(),v(l(K),{key:0})):(c(),v(l(W),{key:1}))])])):x("",!0),t("p",re,[N(i,{to:"/reset-password"},{default:T(()=>e[8]||(e[8]=[k("Forgot Password?")])),_:1})]),t("button",{type:"submit",class:"w-full bg-[#F97316] disabled:cursor-not-allowed cursor-pointer hover:bg-orange-400 rounded-[12px] p-[8px] text-white",disabled:s.value},y(s.value?"Sending.":l(p)?"Login":"Send Verification Email"),9,ne)],32),e[10]||(e[10]=t("div",{class:"text-center mt-6"},[t("p",{class:"text-gray-600"},[k(" Dont have an account? "),t("a",{href:"/create-account",class:"text-[#F97316] font-medium"}," Sign up ")])],-1))])])])],64)}}});export{he as default};
