import{_ as T,r as m,G as I,w as q,o as G,j as H,c as d,k as s,e as i,b as t,i as g,n as y,u as n,f as N,p as w,y as B,l as u,v as C,z as L,A as V,F as R,q as W,g as Y,x as J}from"./index-DTq0z6UM.js";import{_ as K}from"./HeaderNav.vue_vue_type_script_setup_true_lang-C1TlxRfI.js";import{_ as j}from"./button.vue_vue_type_script_setup_true_lang-D4JAwvno.js";import{S as O,n as U}from"./storeUtils-BBgzQjYe.js";import{L as A,A as P}from"./loader-circle-D7JEWCZh.js";import{C as Q,a as $}from"./chevrons-up-down-DMe1vY8A.js";import"./createLucideIcon-BHDqzYJA.js";const X={class:"min-h-screen"},Z={class:"flex items-center gap-2"},ee={key:0},te={class:"max-w-md mx-auto px-4 py-6"},ae={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},se={class:"flex items-center justify-between mb-8"},ne={class:"flex-1 max-w-[100px] mx-4 h-1 bg-gray-200 rounded"},oe={class:"space-y-2"},le={class:"relative"},re={key:0,class:"absolute z-10 w-full mt-1 bg-white border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},de={class:"p-2 sticky top-0 bg-white border-b border-gray-200"},ce={class:"py-1"},ie=["onClick"],ue={key:0,class:"px-4 py-2 text-sm text-gray-500"},me={class:"space-y-2"},ve={class:"relative"},fe=["disabled"],pe={key:0,class:"space-y-2"},be={class:"flex items-center space-x-2 p-3 bg-gray-50 border border-gray-300 rounded-lg"},_e={class:"text-gray-900 font-medium"},ge={key:1,class:"flex items-center justify-center py-4"},ye={class:""},ke={key:0},xe={__name:"Banking.form",setup(D){const r=O,v=r.get("pay","getBanks"),c=r.get("pay","getResolvedAccount"),M=r.get("pay","getLoading"),f=m(!1),x=m(!1),p=m(!1),b=m(""),k=m(!1),S=I(()=>v.value?b.value?v.value.filter(o=>o.name.toLowerCase().includes(b.value.toLowerCase())):v.value:[]),a=m({bank_account_number:"",bank_account_name:"",bank_name:"",bank_code:""});q([()=>a.value.bank_code,()=>c.value],()=>{p.value=!!a.value.bank_code&&!!c.value},{deep:!0});const h=async()=>{var o;if(f.value=!0,!!p.value){a.value.bank_account_name=c.value.account_name,a.value.bank_name=((o=v.value.find(e=>e.code===a.value.bank_code))==null?void 0:o.name)||"";try{const e=await r.dispatch("business","updateBank",a.value);f.value=!1;let _=e.data;_.code==="00"?(U(_.message),await r.dispatch("business","readBank"),await J.push({path:"/settings"})):U(_.message)}catch(e){f.value=!1,console.error(e)}finally{f.value=!1,r.commit("business","resolvedBank",null)}}},z=o=>{a.value.bank_code=o.code,a.value.bank_name=o.name,b.value=o.name,k.value=!1,console.log(a.value)},E=async o=>{x.value=!0,o.length===10&&await r.dispatch("pay","resolve",{account_number:a.value.bank_account_number,bank_code:a.value.bank_code}),x.value=!1},F=()=>{a.value.bank_account_number="",r.commit("pay","resolvedAccount",null)};return G(()=>{r.dispatch("pay","readbank")}),(o,e)=>{const _=H("router-link");return s(),d("div",X,[i(K,null,{title:g(()=>[t("div",Z,[i(_,{to:"/profile",class:"flex items-center"},{default:g(()=>[i(n(P),{class:"w-5 h-5"})]),_:1}),e[4]||(e[4]=t("h1",{class:"text-lg font-medium"},"Update Bank Account",-1))])]),others:g(()=>[i(j,{onClick:h,disabled:!p.value,variant:"outline",class:"w-24 sm:w-28 lg:hidden"},{child:g(()=>[n(M)?(s(),y(n(A),{key:1,class:"w-4 h-4 animate-spin"})):(s(),d("span",ee,"Save"))]),_:1},8,["disabled"])]),_:1}),t("div",te,[t("div",ae,[t("div",se,[e[5]||(e[5]=N('<div class="flex items-center" data-v-8662f369><div class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 text-blue-600" data-v-8662f369><span class="text-sm font-medium" data-v-8662f369>1</span></div><div class="ml-4" data-v-8662f369><h2 class="text-sm font-medium text-gray-900" data-v-8662f369>Bank Details</h2><p class="text-xs text-gray-500" data-v-8662f369>Add your bank account information</p></div></div>',1)),t("div",ne,[t("div",{class:w(`h-full rounded bg-blue-600  ${p.value?"w-full":"w-0"} transition-all duration-300`)},null,2)])]),t("form",{onSubmit:B(h,["prevent"]),class:"space-y-6"},[t("div",oe,[e[6]||(e[6]=t("label",{for:"bank",class:"block text-sm font-medium text-gray-700"},"Select Bank",-1)),t("div",le,[t("div",{onClick:e[0]||(e[0]=l=>k.value=!k.value),class:"flex items-center justify-between w-full p-3 border border-gray-300 rounded-lg bg-white cursor-pointer"},[t("span",{class:w(a.value.bank_code?"text-gray-900 ":"text-gray-500 ")},C(a.value.bank_name||"Select your bank"),3),i(n(Q),{class:"w-4 h-4 text-gray-500"})]),k.value?(s(),d("div",re,[t("div",de,[L(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),type:"text",placeholder:"Search banks...",class:"w-full p-2 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50"},null,512),[[V,b.value]])]),t("div",ce,[(s(!0),d(R,null,W(S.value,l=>(s(),d("button",{key:l.code,onClick:B(we=>z(l),["prevent"]),class:w(["w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center justify-between",{"text-blue-600  font-medium":l.code===a.value.bank_code}])},[Y(C(l.name)+" ",1),l.code===a.value.bank_code?(s(),y(n($),{key:0,class:"w-4 h-4"})):u("",!0)],10,ie))),128)),S.value.length===0?(s(),d("div",ue," No banks found ")):u("",!0)])])):u("",!0)])]),t("div",me,[e[7]||(e[7]=t("label",{for:"accountNumber",class:"block text-sm font-medium text-gray-700"}," Account Number ",-1)),t("div",ve,[L(t("input",{type:"text",id:"accountNumber","onUpdate:modelValue":e[2]||(e[2]=l=>a.value.bank_account_number=l),onInput:e[3]||(e[3]=l=>E(a.value.bank_account_number)),disabled:!!n(c),maxlength:"10",placeholder:"Enter 10-digit account number",class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,fe),[[V,a.value.bank_account_number]]),n(c)?(s(),d("button",{key:0,onClick:B(F,["prevent"]),class:"absolute right-3 top-1/2 -translate-y-1/2 text-blue-600 text-sm font-medium hover:underline"}," Edit ")):u("",!0)])]),n(c)?(s(),d("div",pe,[e[8]||(e[8]=t("label",{for:"accountName",class:"block text-sm font-medium text-gray-700"}," Account Holder ",-1)),t("div",be,[n(c)?(s(),y(n($),{key:0,class:"w-5 h-5 text-green-500 flex-shrink-0"})):u("",!0),t("span",_e,C(n(c).account_name),1)])])):u("",!0),x.value&&!n(c)?(s(),d("div",ge,[i(n(A),{class:"w-6 h-6 text-blue-600 animate-spin"}),e[9]||(e[9]=t("span",{class:"ml-2 text-sm text-gray-600"},"Verifying account...",-1))])):u("",!0),t("div",ye,[i(j,{onClick:h,disabled:!p.value,variant:"outline",class:"w-full"},{child:g(()=>[f.value?(s(),y(n(A),{key:1,class:"w-4 h-4 animate-spin mr-2"})):(s(),d("span",ke,"Save Bank Account"))]),_:1},8,["disabled"])])],32)]),e[10]||(e[10]=N('<div class="mt-6 flex items-start space-x-3 p-4 bg-white rounded-xl border border-gray-200" data-v-8662f369><div class="p-1 bg-blue-100 rounded-full" data-v-8662f369><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8662f369><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-8662f369></path></svg></div><div data-v-8662f369><h3 class="text-sm font-medium text-gray-900" data-v-8662f369>Bank Account Security</h3><p class="mt-1 text-xs text-gray-500" data-v-8662f369> Your bank account details are securely encrypted and protected. We comply with financial industry standards to ensure your data remains safe. </p></div></div>',1))])])}}},he=T(xe,[["__scopeId","data-v-8662f369"]]),je={__name:"UpdateBank.view",setup(D){return(r,v)=>(s(),y(he))}};export{je as default};
